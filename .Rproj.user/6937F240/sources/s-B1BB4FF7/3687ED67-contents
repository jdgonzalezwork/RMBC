### Install and load Packages
## 
packages=c("GSE","dplyr","mvtnorm","ktaucenters","xtable","ellipse"); 
for (i in 1:length(packages)){
  if (packages[i] %in% rownames(installed.packages())==FALSE){ 
         install.packages(packages[i])}
  require(packages[i], character.only = TRUE)
}

# Load the Workspace. 
load("RMBC.RData")

# In the are in the Y matrix, 
# where each row represents an observation
# of dimention 2.

K=2
########################################
##  1 ROBUST ESTIMACION: RMBC ##########
########################################
resultRMBC=RMBC(Y = Y,K= K)

# resultRMBC is a list with the  results 
# of parameters estimation and the clusters labels 
# as well as the outliers and non outliers indices. 
nonOutliers= resultRMBC$nonoutliers


cluster=resultRMBC$cluster

tituloGraf=paste("RMBC (This work)")
  mybool=rep(FALSE,dim(Y)[1])
  mybool[nonOutliers]=T
  nonOutliersEstimadosGraf=mybool
  YGraf=Y; indicesGraf=cluster;
  theta.mu=resultRMBC$mu
  theta.sigma=resultRMBC$Sigma;
  #source("auxPlotGroupsModelBasedCluster.R")
  auxPlotGroupsModelBasedCluster()


